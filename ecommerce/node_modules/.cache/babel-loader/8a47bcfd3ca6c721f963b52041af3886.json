{"ast":null,"code":"import _asyncToGenerator from\"C:\\\\Users\\\\Likith Reddy\\\\Desktop\\\\e-cart\\\\e-cart\\\\ecommerce\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"C:\\\\Users\\\\Likith Reddy\\\\Desktop\\\\e-cart\\\\e-cart\\\\ecommerce\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\Likith Reddy\\\\Desktop\\\\e-cart\\\\e-cart\\\\ecommerce\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useEffect,useState}from\"react\";import{Typography,Button,Divider}from\"@material-ui/core\";import{Elements}from\"@stripe/react-stripe-js\";import{loadStripe}from\"@stripe/stripe-js\";import{CardElement,useElements,useStripe}from\"@stripe/react-stripe-js\";import Review from\"./Review\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var CARD_OPTIONS={iconStyle:\"solid\",style:{base:{iconColor:\"#c4f0ff\",color:\"#fff\",fontWeight:500,fontFamily:\"Roboto, Open Sans, Segoe UI, sans-serif\",fontSize:\"16px\",fontSmoothing:\"antialiased\",\":-webkit-autofill\":{color:\"#fce883\"},\"::placeholder\":{color:\"#87bbfd\"}},invalid:{iconColor:\"#ffc7ee\",color:\"#ffc7ee\"}}};var public_key=\"pk_test_51KER1gSFwkcuCOaPiTIsN1lHIxbyOWkgacf47Z20dT1VdHtsi9yhUE76Nwp7byl7bMH4KrbwC0IZVhcF5QnnWn9b0017VtbsSX\";var stripeTestPromise=loadStripe(public_key);function PaymentForm(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),success=_useState2[0],setSuccess=_useState2[1];var stripe=useStripe();var elements=useElements();var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var payment,id,response,orderData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(elements);e.preventDefault();_context.next=4;return stripe.createPaymentMethod({type:\"card\",card:{number:\"4242424242424242\",exp_month:1,exp_year:2023,cvc:\"314\"}});case 4:payment=_context.sent;console.log(payment);if(payment.error){_context.next=20;break;}_context.prev=7;id=payment.paymentMethod.id;_context.next=11;return axios.post(\"https://localhost:3000/payment\",{amount:1000,id:id});case 11:response=_context.sent;if(response.data.success){console.log(\"Successful payment\");setSuccess(true);}_context.next=18;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](7);console.log(\"Error\",_context.t0);case 18:_context.next=21;break;case 20:console.log(payment.error.message);case 21:orderData={line_items:props.checkOutToken.live.line_items,customer:{firstname:props.shippingData.firstName,lastname:props.shippingData.lastName,email:props.shippingData.email},shipping:{name:\"International\",street:props.shippingData.address1,town_city:props.shippingData.city,county_state:props.shippingData.shippingSubdivision,postal_zip_code:props.shippingData.zip,country:props.shippingData.shippingCountry},fulfillment:{shipping_method:props.shippingData.shippingOption}};props.handleCaptureCheckout(props.checkOutToken.id,orderData);props.nextStep();case 24:case\"end\":return _context.stop();}}},_callee,null,[[7,15]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:!success?/*#__PURE__*/_jsxs(Elements,{stripe:stripeTestPromise,children:[/*#__PURE__*/_jsx(Review,{token:props.checkOutToken}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,style:{margin:\"20px 0\"},children:\"Payment Method\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:function onSubmit(e){return handleSubmit(e);},children:[/*#__PURE__*/_jsx(CardElement,{}),/*#__PURE__*/_jsx(\"br\",{}),\" \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"space-between\"},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:props.backStep,children:\"Back\"}),/*#__PURE__*/_jsxs(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",children:[\"Pay \",props.checkOutToken.live.subtotal.formatted_with_symbol]})]})]})]}):/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h2\",{children:\"you just bought a product\"})})});}export default PaymentForm;","map":{"version":3,"sources":["C:/Users/Likith Reddy/Desktop/e-cart/e-cart/ecommerce/src/components/CheckoutForm/PaymentForm.jsx"],"names":["React","useEffect","useState","Typography","Button","Divider","Elements","loadStripe","CardElement","useElements","useStripe","Review","axios","CARD_OPTIONS","iconStyle","style","base","iconColor","color","fontWeight","fontFamily","fontSize","fontSmoothing","invalid","public_key","stripeTestPromise","PaymentForm","props","success","setSuccess","stripe","elements","handleSubmit","e","console","log","preventDefault","createPaymentMethod","type","card","number","exp_month","exp_year","cvc","payment","error","id","paymentMethod","post","amount","response","data","message","orderData","line_items","checkOutToken","live","customer","firstname","shippingData","firstName","lastname","lastName","email","shipping","name","street","address1","town_city","city","county_state","shippingSubdivision","postal_zip_code","zip","country","shippingCountry","fulfillment","shipping_method","shippingOption","handleCaptureCheckout","nextStep","margin","display","justifyContent","backStep","subtotal","formatted_with_symbol"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { Typography, Button, Divider } from \"@material-ui/core\";\r\nimport { Elements } from \"@stripe/react-stripe-js\";\r\nimport { loadStripe } from \"@stripe/stripe-js\";\r\nimport { CardElement, useElements, useStripe } from \"@stripe/react-stripe-js\";\r\nimport Review from \"./Review\";\r\nimport axios from \"axios\";\r\n\r\nconst CARD_OPTIONS = {\r\n  iconStyle: \"solid\",\r\n  style: {\r\n    base: {\r\n      iconColor: \"#c4f0ff\",\r\n      color: \"#fff\",\r\n      fontWeight: 500,\r\n      fontFamily: \"Roboto, Open Sans, Segoe UI, sans-serif\",\r\n      fontSize: \"16px\",\r\n      fontSmoothing: \"antialiased\",\r\n      \":-webkit-autofill\": { color: \"#fce883\" },\r\n      \"::placeholder\": { color: \"#87bbfd\" },\r\n    },\r\n    invalid: {\r\n      iconColor: \"#ffc7ee\",\r\n      color: \"#ffc7ee\",\r\n    },\r\n  },\r\n};\r\n\r\nconst public_key =\r\n  \"pk_test_51KER1gSFwkcuCOaPiTIsN1lHIxbyOWkgacf47Z20dT1VdHtsi9yhUE76Nwp7byl7bMH4KrbwC0IZVhcF5QnnWn9b0017VtbsSX\";\r\nconst stripeTestPromise = loadStripe(public_key);\r\nfunction PaymentForm(props) {\r\n  const [success, setSuccess] = useState(false);\r\n  const stripe = useStripe();\r\n  const elements = useElements();\r\n  const handleSubmit = async (e) => {\r\n    console.log(elements);\r\n    e.preventDefault();\r\n    const  payment = await stripe.createPaymentMethod({\r\n      type: \"card\",\r\n      card: {\r\n        number: \"4242424242424242\",\r\n        exp_month: 1,\r\n        exp_year: 2023,\r\n        cvc: \"314\",\r\n      },\r\n    });\r\n    console.log(payment);\r\n    if (!payment.error) {\r\n      try {\r\n        const { id } = payment.paymentMethod;\r\n        const response = await axios.post(\"https://localhost:3000/payment\", {\r\n          amount: 1000,\r\n          id,\r\n        });\r\n\r\n        if (response.data.success) {\r\n          console.log(\"Successful payment\");\r\n          setSuccess(true);\r\n        }\r\n      } catch (error) {\r\n        console.log(\"Error\", error);\r\n      }\r\n    } else {\r\n      console.log(payment.error.message);\r\n    }\r\n    const orderData = {\r\n      line_items: props.checkOutToken.live.line_items,\r\n      customer: {\r\n        firstname: props.shippingData.firstName,\r\n        lastname: props.shippingData.lastName,\r\n        email: props.shippingData.email,\r\n      },\r\n      shipping: {\r\n        name: \"International\",\r\n        street: props.shippingData.address1,\r\n        town_city: props.shippingData.city,\r\n        county_state: props.shippingData.shippingSubdivision,\r\n        postal_zip_code: props.shippingData.zip,\r\n        country: props.shippingData.shippingCountry,\r\n      },\r\n      fulfillment: { shipping_method: props.shippingData.shippingOption },\r\n    };\r\n    props.handleCaptureCheckout(props.checkOutToken.id, orderData);\r\n    props.nextStep();\r\n  };\r\n  return (\r\n    <>\r\n      {!success ? (\r\n        <Elements stripe={stripeTestPromise}>\r\n          <Review token={props.checkOutToken} />\r\n          <Divider />\r\n          <Typography variant=\"h6\" gutterBottom style={{ margin: \"20px 0\" }}>\r\n            Payment Method\r\n          </Typography>\r\n          <form onSubmit={(e) => handleSubmit(e)}>\r\n            <CardElement />\r\n            <br /> <br />\r\n            <div style={{ display: \"flex\", justifyContent: \"space-between\" }}>\r\n              <Button variant=\"outlined\" onClick={props.backStep}>\r\n                Back\r\n              </Button>\r\n              <Button type=\"submit\" variant=\"contained\" color=\"primary\">\r\n                Pay {props.checkOutToken.live.subtotal.formatted_with_symbol}\r\n              </Button>\r\n            </div>\r\n          </form>\r\n        </Elements>\r\n      ) : (\r\n        <div>\r\n          <h2>you just bought a product</h2>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default PaymentForm;\r\n"]},"metadata":{},"sourceType":"module"}